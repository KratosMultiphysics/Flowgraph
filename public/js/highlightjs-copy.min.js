class CopyButtonPlugin {
    constructor(options = {}, text = {}) {
        console.log("Entering here 0")
        self.hook = options.hook;
        self.callback = options.callback

        let parentElement = $("#json-display")[0];
        console.log(parentElement)

        console.log("Entering here 1")
        let button = Object.assign(document.createElement("button"), {
            innerHTML: "Copy",
            className: "hljs-copy-button"
        });
        button.dataset.copied = false;
        parentElement.classList.add("hljs-copy-wrapper");
        parentElement.appendChild(button);
        
        button.onclick = function() {
            if (!navigator.clipboard) return;
            navigator.clipboard.writeText(text).then(function() {
                button.innerHTML = "Copied!";
                button.dataset.copied = true;
                let alert = Object.assign(document.createElement("div"), {
                    role: "status",
                    className: "hljs-copy-alert",
                    innerHTML: "Copied to clipboard"
                });
                parentElement.appendChild(alert);
                setTimeout(() => {
                    button.innerHTML = "Copy";
                    button.dataset.copied = false;
                    parentElement.removeChild(alert);
                    alert = null
                }, 2e3)
            })
        }
    }
}